<div *ngIf="form" [ngClass]="{'small-height': modal}">
    <form [formGroup]="form" class="form" (ngSubmit)="form.valid && submit()" novalidate>
        <div class="row">
            <div class="col">
                <div class="form-group">
                    <label for="gender">{{ 'COMMON.GENDER' | translate }}*</label>
                    <br />                        
                    <div class="form-check form-check-inline">
                        <input type="radio" name="gender" id="genderM" value="M"
                            formControlName="gender" class="form-check-input" required>
                        <label for="genderM" class="form-check-label">{{ 'COMMON.GENDER_M' | translate }}</label>
                    </div>
                    <div class="form-check-inline">
                        <input type="radio" name="gender" id="genderF" value="F"
                            formControlName="gender" class="form-check-input" required>
                        <label for="genderF" class="form-check-label">{{ 'COMMON.GENDER_F' | translate }}</label>
                    </div>
                </div>
        
                <div class="form-group">
                    <label for="name">{{ 'COMMON.FIRSTNAME' | translate }}*</label>
                    <input type="text" class="form-control form-control-sm" id="firstname" formControlName="firstname" required />
                    <div *ngIf="firstname.invalid && (firstname.dirty || firstname.touched)" class="invalid-field">
                        {{ 'FORM.REQUIRED' | translate }}
                    </div>
                </div>
                <div class="form-group">
                    <label for="lastname">{{ 'COMMON.LASTNAME' | translate }}*</label>
                    <input type="text" class="form-control form-control-sm" id="lastname" formControlName="lastname" required />
                    <div *ngIf="lastname.invalid && (lastname.dirty || lastname.touched)" class="invalid-field">
                        {{ 'FORM.REQUIRED' | translate }}
                    </div>
                </div>
                <div class="form-group">
                    <label for="mobile">{{ 'COMMON.MOBILE_NO' | translate }}*</label>
                    <input type="text" class="form-control form-control-sm" id="mobile" formControlName="mobile" required />
                    <div *ngIf="mobile.invalid && (mobile.dirty || mobile.touched)" class="invalid-field">
                        <div *ngIf="mobile.errors.required">
                            {{ 'FORM.REQUIRED' | translate }}
                        </div>
                        <div *ngIf="mobile.errors.phoneFormat">
                            Mobile number format is wrong
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="email">{{ 'COMMON.EMAIL' | translate }}</label>
                    <input type="text" class="form-control form-control-sm" id="email" formControlName="email" />
                    <div *ngIf="email.invalid && (email.dirty || email.touched)" class="invalid-field">
                        {{ 'FORM.INVALID_EMAIL' | translate }}
                    </div>
                </div>
                <div class="form-group">
                    <label for="birthdate">{{ 'COMMON.BIRTHDATE' | translate }}</label>
                    <div class="input-group">
                        <input class="form-control form-control-sm" placeholder="yyyy-mm-dd" formControlName="birthdate"
                                id="birthdate" ngbDatepicker #birthdate="ngbDatepicker">
                        <button class="input-group-addon" (click)="birthdate.toggle()" type="button">
                            <i class="fa fa-calendar fa-fw" aria-hidden="true"></i>
                        </button>
                    </div>
                    <div *ngIf="birthdate.invalid && (birthdate.dirty || birthdate.touched)" class="invalid-field">
                        {{ 'FORM.INVALID_DATE' | translate }}
                    </div>
                </div>  
                <div class="form-group" *ngIf="isEdit">
                    <label for="comment">{{ 'CUSTOMERS.CUSTOMER_INFOS' | translate }}</label>
                    <textarea class="form-control form-control-sm" id="comment" name="comment"  ows="5" formControlName="comment"></textarea>
                </div>              
            </div>
            <div class="col">
                <div class="card card-languages">
                    <div class="card-body">
                        <label for="languages">{{ 'COMMON.LANGUAGES' | translate }}</label>
                        <div formArrayName="languages">
                            <div *ngFor="let language of form.controls.languages.controls; let i = index">
                                <div class="row language-control">
                                    <app-autocomplete class="language-picker col-9" small="true"
                                                        source="languages" [formControl]="language">
                                    </app-autocomplete>
                                    <div class="action-btn col">
                                        <button type="button" class="btn btn-danger btn-xs" 
                                                (click)="removeLanguage(i)" *ngIf="i > 0">
                                            <i class="fa fa-minus"></i>
                                        </button>
                                        <button *ngIf="i == form.controls.languages.controls.length - 1"
                                                type="button" class="btn btn-success btn-xs" 
                                                (click)="addLanguage()" [disabled]="anyLanguageEmpty()">
                                            <i class="fa fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <app-address [group]="form.controls.address" hideCountry="true"></app-address>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="form-group" *ngIf="!isEdit">
                    <label for="amount">{{ 'COMMON.AMOUNT' | translate }}*</label>
                    <input type="number" min="0" class="form-control form-control-sm" id="amount"
                            placeholder="AED" formControlName="amount" required>
                    <div *ngIf="amount.invalid && (amount.dirty || amount.touched)" class="invalid-field">
                        {{ 'FORM.REQUIRED' | translate }}
                    </div>
                </div>
            </div>
            <div class="col">
                <label *ngIf="!isEdit" style="display:block">&nbsp;</label>                    
                <app-submit-button value="{{ 'COMMON.SAVE' | translate }}" [form]="form"
                    loadingValue="{{ 'COMMON.SAVING' | translate }}" [subscription]="submitSubscription">
                </app-submit-button>
            </div>
        </div>
        <!-- <pre>{{ form.valid | json }}</pre> -->
    </form>
</div>